# Configuration pour les pages d'erreur animées
# Incluez ce fichier dans votre configuration Nginx principale avec:
# include /chemin/vers/nginx-error-pages.conf;

# Configuration des pages d'erreur
error_page 500 /error-pages/500.html;
error_page 502 /error-pages/502.html;
error_page 503 /error-pages/503.html;
error_page 504 /error-pages/504.html;

# Emplacement des pages d'erreur
# Cette directive permet d'accéder aux pages d'erreur seulement en interne
location ^~ /error-pages/ {
    internal;
    alias /usr/share/nginx/html/error-pages/;
    
    # Ajouter les headers pour éviter les problèmes de cache
    add_header Cache-Control "no-store, no-cache, must-revalidate";
    
    # Permettre l'accès aux ressources CSS et JS
    location ~* \.(css|js)$ {
        add_header Cache-Control "public, max-age=3600";
    }
    
    # Permettre l'accès aux images
    location ~* \.(jpg|jpeg|gif|png|ico|svg)$ {
        add_header Cache-Control "public, max-age=86400";
    }
}

# Exemple de configuration de proxy avec des timeouts appropriés
# Décommentez et ajustez selon vos besoins

# location / {
#     proxy_pass http://your-backend-service;
#     proxy_set_header Host $host;
#     proxy_set_header X-Real-IP $remote_addr;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     proxy_set_header X-Forwarded-Proto $scheme;
#     
#     # Timeouts - ajustez selon vos besoins
#     proxy_connect_timeout 5s;    # Timeout pour la connexion au backend
#     proxy_send_timeout 10s;      # Timeout pour l'envoi des données
#     proxy_read_timeout 10s;      # Timeout pour la lecture des données
#     
#     # Activer les buffers pour de meilleures performances
#     proxy_buffers 16 4k;
#     proxy_buffer_size 2k;
#     
#     # Configurer le comportement en cas d'erreur
#     proxy_next_upstream error timeout http_500 http_502 http_503 http_504;
#     proxy_next_upstream_tries 3;
# }

# Instructions d'installation:
# 1. Copiez les fichiers de pages d'erreur dans /usr/share/nginx/html/error-pages/
# 2. Incluez ce fichier de configuration dans votre fichier nginx.conf principal
# 3. Testez la configuration: nginx -t
# 4. Rechargez Nginx: systemctl reload nginx 